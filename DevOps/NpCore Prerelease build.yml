trigger:
  batch: true
  branches:
    include:
    - master
  paths:
    include:
    - Application
    - Test
    - DevOps    

resources:
  repositories:
  - repository: scriptsRepo
    type: git
    name:  'NpCore/NpDevOps'

  - repository: translations
    type: git
    name: 'NpCore/NpCore-Translations'
    ref: 'refs/heads/i10n_master'

stages:
  - template: /YAML/ZAL Build Definitions/Prerelease build.yml@scriptsRepo
    parameters:
      pool:
        name: NP Core Pipelines
        demands: 
        - docker
        # Now only 2019 is available but in the future it will be every newer version.
        # Then we will probably remove this requirement as it will alwyas TRUE.
        - Agent.OS -equals Windows_NT
        - Agent.OSVersion -equals 10.0.17763
      containerDefinitions:
        - Auto
        - BC1804
        - BC1902  
      analyzers: 'AppSourceCop,UICop,CodeCop'
      keyVaultCert:
        certPFXSecureFile: 'BusinessCentralKeyVaultReader.pfx'
        certPassword: 498eH$??nhxUSSFS
        azureADtenantID: ec3af438-38fc-4d9b-b8be-058101411d3a
        azureKeyVaultClientId: b38b8bef-17d2-4368-84ce-f9880a45eed0
      translations:
        translationsRepo: translations
        translationsTargetRepoName: NpCore-Translations
        translationsTargetRepoBranchName: master
      combinedAppsNuGetSourceUri: https://pkgs.dev.azure.com/navipartner/_packaging/NaviPartner.NavApps/nuget/v3/index.json