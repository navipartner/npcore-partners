# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  globalApiTypes: ./../global-api-types.yml
  commonApiTypes: ./../common-api-types.yml
  simpleTypes: ./simple-types.yml

webhooks:
 
  designer_manifest_created:
    display-name: Manifest Created
    docs:
      Notifies that Business Central (BC) has created or made a new and empty manifest available.
      These webhooks communicate manifest lifecycle events produced by BC to external consumers. 
      Subscribe to `designer_manifest_created` to be informed when a new manifest is created.
    method: POST
    payload: DesignerManifestCreatedEvent
    examples:
      - payload: $DesignerManifestCreatedEvent.Example

  designer_manifest_content_added:
    display-name: Manifest Content Added
    docs:
      Notifies that BC has added one asset to an existing manifest.
      Use this event to inform external consumers that manifest content changed.
      Subscribe to `designer_manifest_content_added` to receive notifications when assets are added to manifests.
    method: POST
    payload: DesignerManifestContentAddEvent
    examples:
      - payload: $DesignerManifestContentAddEvent.Example

  designer_manifest_content_removed:
    display-name: Manifest Content Removed
    docs:
      Notifies that BC has removed one asset from an existing manifest.
      This event is intended to inform external consumers that the manifest content has changed.
      Subscribe to `designer_manifest_content_removed` to receive notifications when assets are removed from manifests.
    method: POST
    payload: DesignerManifestContentRemoveEvent
    examples:
      - payload: $DesignerManifestContentRemoveEvent.Example

  designer_manifest_content_changed:
    display-name: Manifest Content Changed
    docs:
      Notifies that BC has updated content (added or removed a set of assets) within an existing manifest.
      Note that this event is only triggered when multiple assets are changed in a single operation and not for single asset additions or removals.
      Use this event to keep external consumers in sync with the latest manifest state.
      Subscribe to `designer_manifest_content_changed` to receive notifications when manifest content changes.
    method: POST
    payload: DesignerManifestContentChangeEvent
    examples:
      - payload: $DesignerManifestContentChangeEvent.Example

  designer_manifest_deleted:
    display-name: Manifest Deleted
    docs:
      Notifies that BC has deleted a manifest and that it is no longer available.
      This webhook signals the manifest removal to external consumers.
      Subscribe to `designer_manifest_deleted` to be informed when a manifest is deleted.
    method: POST
    payload: DesignerManifestDeletedEvent
    examples:
      - payload: $DesignerManifestDeletedEvent.Example


# TYPES
types:
  # WEBHOOKS
  # designer_manifest_created
  DesignerManifestCreatedEvent:
    properties:
      values: 
        type: list<DesignerManifestCreateObject>
        docs: An array of webhooks, be prepared to handle more than 1 in the same hook request.
    examples:
      - name: Example
        value:
          values:
            - $DesignerManifestCreateObject.Example

  DesignerManifestCreatePayload:
    properties:
      manifestId: simpleTypes.ManifestId
    examples:
      - name: Example
        value:
          manifestId: $simpleTypes.ManifestId.Example

  DesignerManifestCreateObject:
    extends: commonApiTypes.WebhookEvent
    properties:
      payload: DesignerManifestCreatePayload
    examples:
      - name: Example
        value:
          initiatingUserAADObjectId: "ef546153-4168-4bd5-9365-a3161608da72"
          timestamp: "2024-06-28T12:00:00Z"
          companyName: $globalApiTypes.Company.ExampleCompanyCronusFull
          companyId: "b56a418d-8205-4d3a-bdbb-25d94e42abbd"
          appId: "992c2309-cca4-43cb-9e41-911f482ec088"
          clientState: "secret_value_from_subscription_creation_mirrored" 
          eventName: "designer_manifest_created"
          eventVersion: "1.0"
          payload: $DesignerManifestCreatePayload.Example

  # designer_manifest_content_add
  DesignerManifestContentAddEvent:
    properties:
      values:
        type: list<DesignerManifestContentAddObject>
        docs: An array of webhooks, be prepared to handle more than 1 in the same hook request.
    examples:
      - name: Example
        value:
          values:
            - $DesignerManifestContentAddObject.Example

  DesignerManifestContentAddPayload:
    properties:
      manifestId: simpleTypes.ManifestId
      id: simpleTypes.Id
      assetTableNumber: simpleTypes.AssetTableNumber
      assetId: simpleTypes.AssetId
      assetPublicId: simpleTypes.AssetPublicId
      renderWithTemplateId: simpleTypes.RenderWithTemplateId
    examples:
      - name: Example
        value:
          manifestId: $simpleTypes.ManifestId.Example
          id: $simpleTypes.Id.Example
          assetTableNumber: $simpleTypes.AssetTableNumber.Example
          assetId: $simpleTypes.AssetId.Example
          assetPublicId: $simpleTypes.AssetPublicId.Example 
          renderWithTemplateId: $simpleTypes.RenderWithTemplateId.Example

  DesignerManifestContentAddObject:
    extends: commonApiTypes.WebhookEvent
    properties:
      payload: DesignerManifestContentAddPayload
    examples:
      - name: Example
        value:
          initiatingUserAADObjectId: "ef546153-4168-4bd5-9365-a3161608da72"
          timestamp: "2024-06-28T12:00:00Z"
          companyName: $globalApiTypes.Company.ExampleCompanyCronusFull
          companyId: "b56a418d-8205-4d3a-bdbb-25d94e42abbd"
          appId: "992c2309-cca4-43cb-9e41-911f482ec088"
          clientState: "secret_value_from_subscription_creation_mirrored"
          eventName: "designer_manifest_content_added"
          eventVersion: "1.0"
          payload: $DesignerManifestContentAddPayload.Example

  # designer_manifest_content_remove
  DesignerManifestContentRemoveEvent:
    properties:
      values:
        type: list<DesignerManifestContentRemoveObject>
        docs: An array of webhooks, be prepared to handle more than 1 in the same hook request.
    examples:
      - name: Example
        value:
          values:
            - $DesignerManifestContentRemoveObject.Example

  DesignerManifestContentRemovePayload:
    properties:
      manifestId: simpleTypes.ManifestId
      id: simpleTypes.Id
      assetTableNumber: simpleTypes.AssetTableNumber
      assetId: simpleTypes.AssetId
    examples:
      - name: Example
        value:
          manifestId: $simpleTypes.ManifestId.Example
          id: $simpleTypes.Id.Example
          assetTableNumber: $simpleTypes.AssetTableNumber.Example
          assetId: $simpleTypes.AssetId.Example

  DesignerManifestContentRemoveObject:
    extends: commonApiTypes.WebhookEvent
    properties:
      payload: DesignerManifestContentRemovePayload
    examples:
      - name: Example
        value:
          initiatingUserAADObjectId: "ef546153-4168-4bd5-9365-a3161608da72"
          timestamp: "2024-06-28T12:00:00Z"
          companyName: $globalApiTypes.Company.ExampleCompanyCronusFull
          companyId: "b56a418d-8205-4d3a-bdbb-25d94e42abbd"
          appId: "992c2309-cca4-43cb-9e41-911f482ec088"
          clientState: "secret_value_from_subscription_creation_mirrored"
          eventName: "designer_manifest_content_removed"
          eventVersion: "1.0"
          payload: $DesignerManifestContentRemovePayload.Example

  # designer_manifest_content_change
  DesignerManifestContentChangeEvent:
    properties:
      values:
        type: list<DesignerManifestContentChangeObject>
        docs: An array of webhooks, be prepared to handle more than 1 in the same hook request.
    examples:
      - name: Example
        value:
          values:
            - $DesignerManifestContentChangeObject.Example

  DesignerManifestContentChangePayload:
    properties:
      manifestId: simpleTypes.ManifestId
    examples:
      - name: Example
        value:
          manifestId: $simpleTypes.ManifestId.Example

  DesignerManifestContentChangeObject:
    extends: commonApiTypes.WebhookEvent
    properties:
      payload: DesignerManifestContentChangePayload
    examples:
      - name: Example
        value:
          initiatingUserAADObjectId: "ef546153-4168-4bd5-9365-a3161608da72"
          timestamp: "2024-06-28T12:00:00Z"
          companyName: $globalApiTypes.Company.ExampleCompanyCronusFull
          companyId: "b56a418d-8205-4d3a-bdbb-25d94e42abbd"
          appId: "992c2309-cca4-43cb-9e41-911f482ec088"
          clientState: "secret_value_from_subscription_creation_mirrored"
          eventName: "designer_manifest_content_changed"
          eventVersion: "1.0"
          payload: $DesignerManifestContentChangePayload.Example

  # designer_manifest_deleted
  DesignerManifestDeletedEvent:
    properties:
      values:
        type: list<DesignerManifestDeleteObject>
        docs: An array of webhooks, be prepared to handle more than 1 in the same hook request.
    examples:
      - name: Example
        value:
          values:
            - $DesignerManifestDeleteObject.Example

  DesignerManifestDeletePayload:
    properties:
      manifestId: simpleTypes.ManifestId
    examples:
      - name: Example
        value:
          manifestId: $simpleTypes.ManifestId.Example

  DesignerManifestDeleteObject:
    extends: commonApiTypes.WebhookEvent
    properties:
      payload: DesignerManifestDeletePayload
    examples:
      - name: Example
        value:
          initiatingUserAADObjectId: "ef546153-4168-4bd5-9365-a3161608da72"
          timestamp: "2024-06-28T12:00:00Z"
          companyName: $globalApiTypes.Company.ExampleCompanyCronusFull
          companyId: "b56a418d-8205-4d3a-bdbb-25d94e42abbd"
          appId: "992c2309-cca4-43cb-9e41-911f482ec088"
          clientState: "secret_value_from_subscription_creation_mirrored"
          eventName: "designer_manifest_deleted"
          eventVersion: "1.0"
          payload: $DesignerManifestDeletePayload.Example
